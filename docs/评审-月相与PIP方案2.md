你说得对，我补充澄清两点，并给出更贴近你架构的技术方案。

关于“季节与月相”的关系

- 正确理解：季节不改变“相位明亮比例”（phase fraction），但在你的“地球摆正+反推太阳光”架构中，季节引起的太阳方向 Y 轴摆动会改变月面的入射光几何（终止线角度/朝向、明暗边界的倾斜），这必须体现在渲染
几何上。
- 做法：用物理向量统一处理几何变化，而不是写“季节性月相补偿”函数。
    - 主画面光：固定 yaw 的 fixedSunDir，季节仅改仰角，满足构图稳定。
    - 物理几何（PIP/测试）：使用 ephemeris 得到的真实 sunDirWorld、moonDirWorld（这些向量本身就包含了地轴倾角带来的季节摆动），在月球材质里用 Uniform 计算朗伯漫反射和晨昏线。这样季节对几何的影响自
然呈现，而“明亮比例”仍来自 Illumination()。

关于系统架构与“月球自转/潮汐锁定”的考虑

- 我已经按你的架构在建议里划分了“视觉光”和“物理几何”的角色，但确实需要强调“潮汐锁定”在该架构下的特殊处理：
    - 地球垂直固定，通过“对齐 yaw + 经度对齐”来稳定构图，这会不断改变世界坐标下的“地球→月球”方向。
    - 要保证从地球看月球的“同一面”，需为月球施加“潮汐锁定四元数”：令月球的“近地点指向轴”（按模型定义的前向/朝地轴）始终朝向“地球→月球”的反向向量。这样无论地球如何 yaw 对齐，月球贴图方向与近地面都
稳定。
    - PIP 相机从“地球→月球”方向看向月心（你们已有实现），叠加上面的潮汐锁定，终止线的倾斜会随季节/几何变化而正确变化。
- 实施要点（不增第二盏光）：
    - 主画面仍由“单一方向光”打光（fixedSunDir + 季节仰角）；地球/云/大气继续吃这盏光保持构图。
    - 月球材质增加一个 sunDirWorldForShading Uniform，用 ephemeris 的真实向量计算月面明暗（不依赖场景 Light），等价于“月球以自定义照明”，不违反“单光常亮”约束。
    - PIP 使用同一套材质/Uniform，月相与终止线几何由物理向量决定；性能可通过 pip.resolution/fps 控制。

现有代码与上述做法的一致处

- Yaw 锁定顺序：SimpleTest.tsx → AlignOnDemand 先 yaw 对齐再 alignLongitudeOnly()，并支持 seasonalSunDirWorldYUp(fixedYawDeg) 仅改仰角。
- PIP 视角：MoonPIP 已使用“地球→月球”方向取景，正确。
- 物理向量：getEarthState() 与 getMoonPhase() 已提供真实 sunDirWorld、moonDirWorld 与 illumination。

我建议的小改动

- 月球潮汐锁定：在 Moon 组件内增加“指向地球”的四元数（以 earthPosition 与 moonPosition 计算），确保近地面朝向正确且与地球 yaw 解耦。
- 月球材质照明：为月球材质增加 sunDirWorldForShading Uniform，改为基于 Uniform 的朗伯 + terminator 过渡，避免为 PIP 增设直射光。主画面仍保留单一方向光，月球可以忽略这盏光（或保留少量环境贡献）。
- PIP 月球网格：把 PIP 的月球改为 layer=2 的克隆，避免每帧“搬动主月球再还原”的副作用窗口。

如果你认可以上澄清，我可以：

- 更新评审文档，明确“季节影响月面几何但不改变相位比例”的表述，并补充“潮汐锁定在该架构下的实现要点”。
- 起草 Moon 材质改造（Uniform 照明）与潮汐锁定四元数的最小补丁，先仅在 PIP 路径启用，风险可控。是否推进到代码层？